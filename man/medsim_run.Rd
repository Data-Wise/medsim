% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runner.R
\name{medsim_run}
\alias{medsim_run}
\title{Run Simulation Study}
\usage{
medsim_run(
  method,
  scenarios,
  config,
  compute_truth = NULL,
  parallel = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{method}{Function: User-defined simulation method. Must accept two
arguments: \code{data} (data.frame) and \code{params} (list). Should return a named
list of results.}

\item{scenarios}{List of scenario objects from \code{\link[=medsim_scenario]{medsim_scenario()}} or
\code{\link[=medsim_scenarios_mediation]{medsim_scenarios_mediation()}}}

\item{config}{Configuration object from \code{\link[=medsim_config]{medsim_config()}}}

\item{compute_truth}{Function: Optional function to compute ground truth.
Takes same arguments as \code{method}. If NULL, no ground truth computed.}

\item{parallel}{Logical: Use parallel processing (default TRUE)}

\item{verbose}{Logical: Print progress messages (default TRUE)}
}
\value{
A medsim_results object (list) containing:
\itemize{
\item \code{results}: data.frame with all simulation results
\item \code{summary}: data.frame with summary statistics
\item \code{truth}: data.frame with ground truth values (if compute_truth provided)
\item \code{config}: configuration used
\item \code{scenarios}: scenarios used
\item \code{method_name}: name of method function
\item \code{timestamp}: when simulation was run
}
}
\description{
Executes a complete simulation study by running a user-defined method across
multiple scenarios and replications. Supports parallel processing and
automatic result aggregation.
}
\details{
\subsection{Method Function Requirements}{

The \code{method} function must:
\itemize{
\item Accept \code{data} (data.frame) as first argument
\item Accept \code{params} (list) as second argument
\item Return a named list with at least one numeric element
}

Example:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{my_method <- function(data, params) \{
  fit_m <- lm(M ~ X, data = data)
  fit_y <- lm(Y ~ X + M, data = data)

  a <- coef(fit_m)["X"]
  b <- coef(fit_y)["M"]

  list(
    indirect = a * b,
    a_path = a,
    b_path = b,
    se_indirect = ...,  # Optional
    ci_lower = ...,     # Optional
    ci_upper = ...      # Optional
  )
\}
}\if{html}{\out{</div>}}
}

\subsection{Parallel Processing}{

When \code{parallel = TRUE}:
\itemize{
\item Uses \code{\link[=medsim_run_parallel]{medsim_run_parallel()}} internally
\item Number of cores from \code{config$n_cores}
\item Progress bars shown (local) or suppressed (cluster)
\item All necessary objects exported to workers
}
}

\subsection{Ground Truth}{

If \code{compute_truth} is provided:
\itemize{
\item Computed once per scenario (cached automatically)
\item Used to calculate errors/bias in results
\item Can use Monte Carlo or analytical methods
}
}
}
\examples{
\dontrun{
# Define method
my_method <- function(data, params) {
  fit_m <- lm(M ~ X, data = data)
  fit_y <- lm(Y ~ X + M, data = data)
  list(indirect = coef(fit_m)["X"] * coef(fit_y)["M"])
}

# Configure and run
config <- medsim_config("local")
scenarios <- medsim_scenarios_mediation()

results <- medsim_run(
  method = my_method,
  scenarios = scenarios,
  config = config
)

# View results
print(results)
summary(results)
}

}
\seealso{
\code{\link[=medsim_config]{medsim_config()}}, \code{\link[=medsim_scenario]{medsim_scenario()}}, \code{\link[=medsim_run_parallel]{medsim_run_parallel()}}
}
